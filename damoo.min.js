/*! Damoo v2.1.4 | Copyright (c) 2015 James Liu | Released under the MIT license */
;(function(a){var d=function(b,c,f,e){if(!(this instanceof d))return new d(b,c,f,e);this.canvas=new h(b,c,f,e);this.thread=new g(f);this.state=this.afid=null};d.version="v2.1.4";d.dom=a.document;var n=a.requestAnimationFrame||a.mozRequestAnimationFrame||a.webkitRequestAnimationFrame||a.msRequestAnimationFrame||a.oRequestAnimationFrame||function(b){return setTimeout(b,17)},p=a.cancelAnimationFrame||a.mozCancelAnimationFrame||a.webkitCancelAnimationFrame||a.webkitCancelRequestAnimationFrame||a.msCancelAnimationFrame||
a.oCancelAnimationFrame||function(b){clearTimeout(b)};d.prototype.show=function(){this.canvas.parent.appendChild(this.canvas.layer)};d.prototype.hide=function(){this.canvas.parent.removeChild(this.canvas.layer)};d.prototype.emit=function(b){var c=b,f=this.canvas.font,e=d.dom.createElement("canvas"),a=e.getContext("2d");e.width=f.size*c.text.length*1.2;e.height=1.2*f.size;a.font=f.value;a.textAlign="start";a.textBaseline="top";c.shadow&&(a.fillStyle="#fff",a.fillStyle=c.shadow.color,a.fillText(c.text,
1,1));a.fillStyle="#fff";a.fillStyle=c.color;a.fillText(c.text,0,0);if(c.fixed){for(var f=a.getImageData(0,0,e.width,e.height),g=e.height-1,k,h=0,c=f.data;0<=g;g--)for(k=e.width-1;0<=k;k--)0!=c[4*(g*e.width+k)+3]&&k>h&&(h=k+1);e.width=h;a.putImageData(f,0,0)}this.thread.push({canvas:e,fixed:b.fixed,index:this.thread.index,speed:.6*Math.pow(e.width,1/3),offset:{x:this.canvas.width,y:this.canvas.font.size*this.thread.index}})};d.prototype.clear=function(){this.thread.empty()};var l=function(){this.canvas.clear();
for(var b=0;b<this.thread.length;b++){var c=this.thread.get(b),a=c.offset.x;this.canvas.draw(c,a,c.offset.y);c.offset.x-=c.speed;a<=-c.canvas.width&&this.thread.remove(b)}this.afid=n(function(b){return function(){l.call(b)}}(this))};d.prototype.start=function(){this.state||(l.call(this),this.state=1)};d.prototype.suspend=function(){p(this.afid);this.state=0};d.prototype.resume=function(){this.start()};var h=function(b,c,a,e){this.parent=d.dom.getElementById(b);this.parent.style.position="relative";
this.id=c;this.rows=a;12>this.height/this.rows&&(this.rows=this.height/12);this.width=this.parent.offsetWidth;this.height=this.parent.offsetHeight;this.font=new m(this.height/this.rows,e||"sans-serif");this.layer=d.dom.createElement("canvas");this.context=this.layer.getContext("2d");this.layer.id=this.id;this.layer.width=this.width;this.layer.height=this.height;this.layer.style.display="block";this.layer.style.backgroundColor="transparent";this.layer.style.position="absolute";this.layer.style.left=
0;this.layer.style.top=0;this.layer.style.zIndex=99999};h.prototype.clear=function(){this.context.clearRect(0,0,this.width,this.height)};h.prototype.draw=function(b,a,d){b.fixed?this.context.drawImage(b.canvas,(this.width-b.canvas.width)/2+.5|0,d+.5|0):this.context.drawImage(b.canvas,a+.5|0,d+.5|0)};var m=function(b,a){this.size=b;this.family=a};Object.defineProperty(m.prototype,"value",{get:function(){return this.size+"px "+this.family}});var g=function(a){this.index=0;this.rows=a;this.pool=[]};
g.prototype.push=function(a){this.index++;this.index>=this.rows&&(this.index=0);this.pool.push(a)};g.prototype.get=function(a){return this.pool[a]};g.prototype.remove=function(a){var c=this.get(a).index;this.index>c&&(this.index=c);this.pool.splice(a,1)};g.prototype.empty=function(){this.index=0;this.pool=[]};Object.defineProperty(g.prototype,"length",{get:function(){return this.pool.length}});a.Damoo=d})(window);